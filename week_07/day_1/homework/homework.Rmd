---
title: "R Notebook"
output: html_notebook
---
```{r}
library(dplyr)
library(lubridate)
library(tidyverse)
library(tsibble)
library(tsibbledata)
library(feasts)
library(nycflights13)

date1 <- ymd_hms("2017-04-22 22:01:18")
date2 <- ymd_hms("2001-11-07 10:09:56")


```

# Dates and Times
Question 1

Extract the different components (year, month, mday, yday, wday) from the variable date1. Add the labels to the month and do not abbreviate the month labels.
```{r}
year(date1)
month(date1)
mday(date1)
yday(date1)
wday(date1)
```

Question 2

```{r}
next_fortnight <- date1 + days(14)

previous_decade <- date2 - years(10)
```

Question 3

```{r}
this_year <- today()

interval_years <- lubridate::interval(this_year, previous_decade)
```


Question 4

```{r}
nyc_date1 <- with_tz(date1, "America/New_York")
nyc_date2 <- with_tz(date2, "America/New_York")
```

Question 5

```{r}
flights %>% 
  mutate(departure_date = make_datetime(year, month, day, hour, minute))
```

# Time series familiarity
Question 6

Start with the weather data from the nycflights13 package. Select all the variables related to temperature, humidity, and precipitation, and pick out the key and index variables. Have a look at your data, and write a small description of the time series you observe.

```{r}
head(weather)

weather <- weather %>% 
  select(temp, humid, precip, time_hour)

#key is origin?
#Index is  time_hour
#Hourly data of 2 months in 2013
```

Question 7

Change the weather data into a tsibble.

```{r}
weather <- weather %>% 
  as_tsibble(key = temp, index = time_hour)
```


Question 8

Add a year and month column to your weather data, and create a basic line plot which shows the temperature data from each airport over time. Have a think back to what you learned in visualisation week, and think about whether plotting the whole time series in one go is adequate here? Write down your suggestions for what could be done to make a better and more informative plot.
```{r}
weather <- weather %>% 
  mutate(year = year(year),
         month = month(month))

weather %>%
  ggplot(aes(time_hour, temp)) +
  geom_line()

```

Question 9

Choose an appropriate rolling window and calculate a moving average for your weather temperature data for each airport origin. Create a useful plot which overlays the original time series data and the rolling average data. Make sure the graph is easy for others to understand (Hint: you might want to facet_wrap). Finally, write a summary of why you chose the time window you did, and describe any trends you see.

Question 10

Downsample your data so that you plot daily temperature data for each airport, instead of hourly data.

Question 11

Decompose your daily time series data (the downsampled one) using an appopriate downsampling technique. Justify your choice, and explain what the decomposition shows you. Does it tell you anything about the seasonality that you couldnâ€™t see before?

Question 12

Extract features from your downsampled data. Which airport has the strongest trend?

















